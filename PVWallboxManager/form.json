{
  "elements": [
    {
      "type": "ExpansionPanel",
      "caption": "🛑 Modulsteuerung -",
      "items": [
        {
          "type": "CheckBox",
          "name": "ModulAktiv",
          "caption": "Modul aktiv (bei Deaktivierung werden keine Aktionen ausgeführt)"}
      ]
    },
    {
      "type": "ExpansionPanel",
      "caption": "🔌 Wallbox-Konfiguration",
      "items": [
        { "type": "Label", "label": "⚙️ Konfiguriere hier deine GO-e Wallbox und Ladeparameter." },
        { "type": "Label", "label": "🆔 Auswahl deiner GO-e Charger Instanz:" },
        { "type": "SelectInstance", "name": "GOEChargerID", "caption": "GO-e Instanz", "validClasses": ["GOeCharger"] },
        { "type": "Label", "label": "🔧 Minimale Stromstärke in Ampere für den Ladevorgang (ganzzahlig, z.B. 6)." },
        { "type": "NumberSpinner", "name": "MinAmpere", "caption": "Minimaler Ladestrom (A)" },
        { "type": "Label", "label": "🔧 Maximale Stromstärke in Ampere für den Ladevorgang (ganzzahlig, z.B. 16)." },
        { "type": "NumberSpinner", "name": "MaxAmpere", "caption": "Maximaler Ladestrom (A)" },
        { "type": "Label", "label": "⚡ Mindestüberschuss, ab dem die Wallbox lädt (in Watt, nur positiv)." },
        { "type": "NumberSpinner", "name": "MinLadeWatt", "caption": "Start bei PV-Überschuss (W)" },
        { "type": "Label", "label": "🛑 Leistungsgrenze, unter der die Ladung gestoppt wird (in Watt, kann auch negativ für Defizit sein)." },
        { "type": "NumberSpinner", "name": "MinStopWatt", "caption": "Stoppen bei Defizit (W)" }
      ]
    },
    {
      "type": "ExpansionPanel",
      "caption": "🌞 Energiequellen",
      "items": [
        { "type": "Label", "label": "🌅 PV-Erzeugung (Pflichtvariable): Leistung der PV-Anlage in Watt. Immer positiv." },
        { "type": "SelectVariable", "name": "PVErzeugungID", "caption": "PV-Erzeugung (W)", "validVariableTypes": [2] },
        { "type": "Label", "label": "🔌 Netzeinspeisung (optional): Positiv = Einspeisung, negativ = Bezug. Einheit: Watt." },
        { "type": "RowLayout", "items": [
          { "type": "SelectVariable", "name": "NetzeinspeisungID", "caption": "Netzeinspeisung (W)" },
          { "type": "Label", "caption": "         " },
          { "type": "CheckBox", "name": "InvertNetzeinspeisung", "caption": "invertieren" }
        ]},
        { "type": "Label", "label": "🏠 Hausverbrauch (Pflichtvariable): Aktueller Gesamtverbrauch in Watt. Sollte normalerweise immer positiv sein. Falls dein Zähler negativ liefert, hier invertieren." },
        { "type": "RowLayout", "items": [
          { "type": "SelectVariable", "name": "HausverbrauchID", "caption": "Hausverbrauch (W) - Wallboxleistung zum Fahrzeug", "validVariableTypes": [2] },
          { "type": "Label", "caption": "         " },
          { "type": "CheckBox", "name": "InvertHausverbrauch", "caption": "invertieren" }
        ]},
        { "type": "Label", "label": "🔋 Batterieladung (optional): Lade- oder Entladeleistung der Hausbatterie in Watt. Positiv = Laden, negativ = Entladen. Falls dein System umgekehrte Vorzeichen liefert, hier invertieren. Wenn keine Variable ausgewählt ist, wird 0 verwendet." },
        { "type": "RowLayout", "items": [
          { "type": "SelectVariable", "name": "BatterieladungID", "caption": "Batterieladung (W)", "validVariableTypes": [2] },
          { "type": "Label", "caption": "         " },
          { "type": "CheckBox", "name": "InvertBatterieladung", "caption": "invertieren" }
        ]},
        { "type": "Label", "label": "🔄 Intervall für die Leistungsberechnung in Sekunden (15–600)." },
        { "type": "NumberSpinner", "name": "RefreshInterval", "caption": "Aktualisierungsintervall (s)", "minimum": 15, "maximum": 600 }
      ]
    },
    {
      "type": "ExpansionPanel",
      "caption": "⚡ Phasenumschaltung",
      "items": [
        { "type": "Label", "label": "🔢 Anfangswert Anzahl aktiver Phasen (1 oder 3)." },
        { "type": "NumberSpinner", "name": "Phasen", "caption": "Anzahl Phasen (Initialwert)" },
        { "type": "Label", "label": "⬇️ Schwelle in Watt zum Umschalten auf 1-phasig (positiv, z.B. 1000)." },
        { "type": "NumberSpinner", "name": "Phasen1Schwelle", "caption": "Schwelle auf 1-phasig (W)" },
        { "type": "Label", "label": "⬆️ Schwelle in Watt zum Umschalten auf 3-phasig (positiv, z.B. 4200)." },
        { "type": "NumberSpinner", "name": "Phasen3Schwelle", "caption": "Schwelle auf 3-phasig (W)" },
        { "type": "Label", "label": "🔢 Zählerlimit für stabile Umschaltung auf 1-phasig (ganzzahlig)." },
        { "type": "NumberSpinner", "name": "Phasen1Limit", "caption": "Zählerlimit 1-phasig" },
        { "type": "Label", "label": "🔢 Zählerlimit für stabile Umschaltung auf 3-phasig (ganzzahlig)." },
        { "type": "NumberSpinner", "name": "Phasen3Limit", "caption": "Zählerlimit 3-phasig" }
      ]
    },
    {
      "type": "ExpansionPanel",
      "caption": "🧠 Intelligente Logik",
      "items": [
        { "type": "Label", "label": "🧮 Aktiviert dynamischen Sicherheitsabzug bei der Leistungsberechnung (Empfehlung: aktivieren bei PV-Überschussladung)." },
        { "type": "CheckBox", "name": "DynamischerPufferAktiv", "caption": "Dynamischen Puffer aktivieren" },
        { "type": "Label", "label": "🚗 Nur laden wenn Fahrzeug erkannt ist (Status 2 oder 4, siehe GO-e Doku)." },
        { "type": "CheckBox", "name": "NurMitFahrzeug", "caption": "Nur laden, wenn Fahrzeug verbunden" },
        { "type": "Label", "label": "⚖️ PV-Leistung anteilig zwischen Haus und Auto aufteilen." },
        { "type": "CheckBox", "name": "PVVerteilenAktiv", "caption": "PV-Leistung aufteilen aktivieren" },
        { "type": "Label", "label": "🚗 Anteil des PV-Überschusses fürs Fahrzeug in Prozent (nur bei aktivierter Aufteilung)." },
        { "type": "NumberSpinner", "name": "PVAnteilAuto", "caption": "Anteil fürs Fahrzeug (%)", "suffix": "%", "visible": { "name": "PVVerteilenAktiv", "equals": true } },
        { "type": "Label", "label": "🔋 Hausakku SoC zur Berücksichtigung bei voller Batterie (nur bei aktivierter Aufteilung, Einheit: %)." },
        { "type": "SelectVariable", "name": "HausakkuSOCID", "caption": "Hausakku SoC (%)", "visible": { "name": "PVVerteilenAktiv", "equals": true } },
        { "type": "Label", "label": "🔋 Schwelle ab wann Hausakku als voll gilt (nur bei aktivierter Aufteilung, 50–100%)." },
        { "type": "NumberSpinner", "name": "HausakkuSOCVollSchwelle", "caption": "Voll-Schwelle Hausbatterie (%)", "suffix": "%", "minimum": 50, "maximum": 100, "visible": { "name": "PVVerteilenAktiv", "equals": true } },
        { "type": "Label", "label": "⏱️ Stunden vor Zielzeit, ab wann aktiv geladen wird (ganzzahlig, 1–12 h)." },
        { "type": "NumberSpinner", "name": "TargetChargePreTime", "caption": "Umschaltzeit vor Zielzeit (h)", "suffix": "h", "minimum": 1, "maximum": 12 }
      ]
    },
    {
      "type": "ExpansionPanel",
      "caption": "🚗 Fahrzeugdaten",
      "items": [
        { "type": "Label", "label": "📊 Fahrzeugdaten für SoC-basierte Ladesteuerung verwenden (optional)." },
        { "type": "CheckBox", "name": "UseCarSOC", "caption": "Fahrzeugdaten berücksichtigen" },
        { "type": "Label", "label": "🔋 Aktueller SoC des Fahrzeugs (State of Charge, Einheit: %, positiv)." },
        { "type": "SelectVariable", "name": "CarSOCID", "caption": "Aktueller SoC (Variable)" },
        { "type": "Label", "label": "🔋 Fallback SoC in %, wenn keine Variable angegeben ist (positiv)." },
        { "type": "NumberSpinner", "name": "CarSOCFallback", "caption": "Fallback SoC (%)", "suffix": "%" },
        { "type": "Label", "label": "🎯 Ziel-SoC für das Fahrzeug (Einheit: %, positiv, z.B. 80)." },
        { "type": "SelectVariable", "name": "CarTargetSOCID", "caption": "Ziel-SoC (Variable)" },
        { "type": "Label", "label": "🎯 Fallback Ziel-SoC in %, wenn keine Variable angegeben ist (positiv, z.B. 80)." },
        { "type": "NumberSpinner", "name": "CarTargetSOCFallback", "caption": "Fallback Ziel-SoC (%)", "suffix": "%" },
        { "type": "Label", "label": "🔋 Batteriekapazität des Fahrzeugs in kWh (z. B. 52 für ID.3 Pure)." },
        { "type": "NumberSpinner", "name": "CarBatteryCapacity", "caption": "Batteriekapazität (kWh)", "suffix": "kWh" }
      ]
    }
  ]
}
