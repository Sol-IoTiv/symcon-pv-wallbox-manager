{
  "elements": [
    {
      "type": "ExpansionPanel",
      "caption": "üõë Modulsteuerung",
      "items": [
        { "type": "CheckBox", "name": "ModulAktiv", "caption": "‚ö° Modul aktiv (bei Deaktivierung werden keine Aktionen ausgef√ºhrt)"},
        { "type": "CheckBox", "name": "DebugLogging", "caption": "üêû Debug-Logging aktivieren (Details zu allen Variablen und Werten ins IPS-Log)", "default": false }
      ]
    },
    {
      "type": "ExpansionPanel",
      "caption": "üîå Wallbox-Konfiguration",
      "icon": "Plug",
      "items": [
        { "type": "Label", "label": "‚öôÔ∏è Konfiguriere hier deine GO-e Wallbox und Ladeparameter & üîå Ladestr√∂me." },
        { "type": "RowLayout", "items": [
          { "type": "SelectInstance", "name": "GOEChargerID", "caption": "GO-e Instanz", "validClasses": ["GOeCharger"], "icon": "Plug" },
          { "type": "Label", "caption": "    " },
          { "type": "NumberSpinner", "name": "MinAmpere", "caption": "Minimaler Ladestrom (A)", "icon": "Minus" },
          { "type": "Label", "caption": "    " },
          { "type": "NumberSpinner", "name": "MaxAmpere", "caption": "Maximaler Ladestrom (A)", "icon": "Plus" }
        ]},
        { "type": "Label", "caption": "    " },
        { "type": "Label", "label": "üü¢ Startwert: Ab diesem PV-√úberschuss startet das Laden. Die Hysterese legt fest, wie oft der Wert √ºberschritten sein muss." },
        { "type": "RowLayout", "items": [
          { "type": "NumberSpinner", "name": "MinLadeWatt", "caption": "Start bei PV-√úberschuss (W)", "icon": "Play" },
          { "type": "Label", "caption": "    " },
          { "type": "NumberSpinner", "name": "StartHysterese", "caption": "Start-Hysterese (Zyklen)", "suffix": "Zyklen", "default": 0, "minimum": 0, "maximum": 10, "icon": "Repeat" }
        ]},
        { "type": "Label", "caption": "    " },
        { "type": "Label", "label": "üõë Stopwert: Unter diesem Wert wird die Ladung gestoppt. Hysterese = wie oft der Wert unterschritten sein muss." },
        { "type": "RowLayout", "items": [
          { "type": "NumberSpinner", "name": "MinStopWatt", "caption": "Stop bei fehlendem PV-√úberschuss (W)", "icon": "Pause" },
          { "type": "Label", "caption": "    " },
          { "type": "NumberSpinner", "name": "StopHysterese", "caption": "Stop-Hysterese (Zyklen)", "suffix": "Zyklen", "default": 0, "minimum": 0, "maximum": 10, "icon": "Repeat" }
        ]}
      ]
    },
    {
      "type": "ExpansionPanel",
      "caption": "üåû Energiequellen",
      "items": [
        { "type": "Label", "label": "üåÖ PV-Erzeugung (Pflichtvariable): Leistung der PV-Anlage." },
        { "type": "RowLayout", "items": [
          { "type": "SelectVariable", "name": "PVErzeugungID", "caption": "PV-Erzeugung", "validVariableTypes": [2] },
          { "type": "Label", "caption": "    " },
          { "type": "Select", "name": "PVErzeugungEinheit", "caption": "Einheit", "options": [
            { "caption": "Watt (W)", "value": "W" },
            { "caption": "Kilowatt (kW)", "value": "kW" } ], "default": "W" }
        ]},
        { "type": "Label", "label": "üîå Netzeinspeisung (optional): Positiv = Einspeisung, negativ = Bezug. Einheit: Watt." },
        { "type": "RowLayout", "items": [
          { "type": "SelectVariable", "name": "NetzeinspeisungID", "caption": "Netzeinspeisung" },
          { "type": "Label", "caption": "    " },
          { "type": "Select", "name": "NetzeinspeisungEinheit", "caption": "Einheit", "options": [
            { "caption": "Watt (W)", "value": "W" },
            { "caption": "Kilowatt (kW)", "value": "kW" } ], "default": "W" },
          { "type": "Label", "caption": "         " },
          { "type": "CheckBox", "name": "InvertNetzeinspeisung", "caption": "Normal positiv. Falls dein Z√§hler negativ liefert, hier invertieren." }
        ]},
        { "type": "Label", "label": "üè† Hausverbrauch (Pflichtvariable): Aktueller Gesamtverbrauch." },
        { "type": "RowLayout", "items": [
          { "type": "SelectVariable", "name": "HausverbrauchID", "caption": "Gesamter Hausverbrauch", "validVariableTypes": [2] },
          { "type": "Label", "caption": "    " },
          { "type": "Select", "name": "HausverbrauchEinheit", "caption": "Einheit", "options": [
            { "caption": "Watt (W)", "value": "W" },
            { "caption": "Kilowatt (kW)", "value": "kW" } ], "default": "W" },
          { "type": "Label", "caption": "         " },
          { "type": "CheckBox", "name": "InvertHausverbrauch", "caption": "Normal positiv. Falls dein Z√§hler negativ liefert, hier invertieren." }
        ]},
        { "type": "Label", "label": "üîã Batterieladung (optional): Lade- oder Entladeleistung der Hausbatterie. Wenn keine Variable ausgew√§hlt ist, wird 0 verwendet." },
        { "type": "RowLayout", "items": [
          { "type": "SelectVariable", "name": "BatterieladungID", "caption": "Batterieladung", "validVariableTypes": [2] },
          { "type": "Label", "caption": "    " },
          { "type": "Select", "name": "BatterieladungEinheit", "caption": "Einheit", "options": [
            { "caption": "Watt (W)", "value": "W" },
            { "caption": "Kilowatt (kW)", "value": "kW" } ], "default": "W" },
          { "type": "Label", "caption": "         " },
          { "type": "CheckBox", "name": "InvertBatterieladung", "caption": "Positiv = Laden, negativ = Entladen. Falls dein System umgekehrte Vorzeichen liefert, hier invertieren." }
        ]},
        { "type": "Label", "label": "üîÑ Intervall f√ºr die Leistungsberechnung in Sekunden (15‚Äì600)." },
        { "type": "NumberSpinner", "name": "RefreshInterval", "caption": "Aktualisierungsintervall (s)", "minimum": 15, "maximum": 600 }
      ]
    },
    {
      "type": "ExpansionPanel",
      "caption": "‚ö° Phasenumschaltung",
      "items": [
        { "type": "Label", "label": "üî¢ Anfangswert Anzahl aktiver Phasen (1 oder 3)." },
        { "type": "NumberSpinner", "name": "Phasen", "caption": "Anzahl Phasen (Initialwert)" },
        { "type": "Label", "caption": "    " },
        { "type": "Label", "label": "‚¨áÔ∏è Schwelle in Watt zum Umschalten auf 1-phasig & üî¢ Z√§hlerlimit f√ºr stabile Umschaltung auf 1-phasig." },
         { "type": "RowLayout", "items": [
           { "type": "NumberSpinner", "name": "Phasen1Schwelle", "caption": "Schwelle auf 1-phasig (W)" },
           { "type": "Label", "caption": "    " },
            { "type": "NumberSpinner", "name": "Phasen1Limit", "caption": "Z√§hlerlimit 1-phasig" }
        ]},
        { "type": "Label", "caption": "    " },
        { "type": "Label", "label": "‚¨ÜÔ∏è Schwelle in Watt zum Umschalten auf 3-phasig & üî¢ Z√§hlerlimit f√ºr stabile Umschaltung auf 3-phasig." },
           { "type": "RowLayout", "items": [
             { "type": "NumberSpinner", "name": "Phasen3Schwelle", "caption": "Schwelle auf 3-phasig (W)" },
             { "type": "Label", "caption": "    " },
             { "type": "NumberSpinner", "name": "Phasen3Limit", "caption": "Z√§hlerlimit 3-phasig" }
        ]}
      ]
    },
    {
      "type": "ExpansionPanel",
      "caption": "üß† Intelligente Logik",
      "items": [
        { "type": "RowLayout", "items": [
          { "type": "CheckBox", "name": "DynamischerPufferAktiv", "caption": "üßÆ Dynamischen Puffer aktivieren" }
        ]},
        { "type": "RowLayout", "items": [
          { "type": "CheckBox", "name": "NurMitFahrzeug", "caption": "üöó Nur laden, wenn Fahrzeug verbunden" }
        ]},
        { "type": "Label", "caption": "    " },
        { "type": "Label", "label": "Erlaubt die Entladung der Hausbatterie zur Unterst√ºtzung des PV-√úberschussladens." },
        { "type": "Label", "label": "Kann extern √ºber ein Skript gesteuert werden (z.‚ÄØB. f√ºr Passivmodus)." },
        { "type": "CheckBox", "name": "AllowBatteryDischarge", "caption": "PV-Batterieentladung zulassen", "default": true, "icon": "BatteryCharging"},
        { "type": "Label", "caption": "    " },
        { "type": "Label", "label": "‚öñÔ∏è PV-Leistung aufteilen zwischen Haus und Auto aufteilen.(PV2Car-Regelung)" },
        { "type": "RowLayout", "items": [
          { "type": "CheckBox", "name": "PVVerteilenAktiv", "caption": "PV-Leistung aufteilen aktivieren" },
          { "type": "Label", "caption": "    " },
          { "type": "NumberSpinner", "name": "PVAnteilAuto", "caption": "Anteil f√ºrs Fahrzeug (%)", "suffix": "%", "visible": { "name": "PVVerteilenAktiv", "equals": true } },
          { "type": "Label", "caption": "    " },
          { "type": "SelectVariable", "name": "HausakkuSOCID", "caption": "Hausakku SoC (%)", "visible": { "name": "PVVerteilenAktiv", "equals": true } },
          { "type": "Label", "caption": "    " },
          { "type": "NumberSpinner", "name": "HausakkuSOCVollSchwelle", "caption": "Voll-Schwelle Hausbatterie (%)", "suffix": "%", "minimum": 50, "maximum": 100, "visible": { "name": "PVVerteilenAktiv", "equals": true } }
        ]},
        { "type": "Label", "caption": "    " },
        { "type": "Label", "label": "‚è∞ Zielzeit-Ladung: Definiert, wie viele Stunden vor der eingestellten Zielzeit (z.‚ÄØB. 06:00 Uhr) mit garantiertem Laden begonnen wird. Davor wird vorrangig nur mit PV-√úberschuss geladen." },
        { "type": "RowLayout", "items": [
          { "type": "NumberSpinner", "name": "TargetChargePreTime", "caption": "‚è±Ô∏è Umschaltzeit vor Zielzeit (h)", "suffix": "h", "minimum": 1, "maximum": 12 }
        ]},
        { "type": "Label", "caption": "    " },
        { "type": "Label", "label": "üí∂ Strompreisbasiertes Laden (dynamische Tarife)" },
        { "type": "Label", "label": "‚ö†Ô∏è Aktivierung nur √ºber den '‚Ç¨ Strompreisladen aktiv' Button im WebFront! L√§dt, wenn Strompreis ‚â§ H√∂chstpreis" },
        { "type": "RowLayout", "items": [
          { "type": "SelectVariable", "name": "CurrentPriceID", "caption": "Aktueller Strompreis (ct/kWh)", "validVariableTypes": [2] },
          { "type": "Label", "caption": "    " },
          { "type": "SelectVariable", "name": "ForecastPriceID", "caption": "24h-Preisprognose (ct/kWh, Array)", "validVariableTypes": [3], "optional": true },
          { "type": "Label", "caption": "    " },
          { "type": "NumberSpinner", "name": "MaxPrice", "caption": "H√∂chstpreis (ct/kWh)", "suffix": "ct/kWh", "digits": 3, "minimum": 0.000, "maximum": 999.999, "default": 0.000, "enabled": false }
        ]}
      ]
    },
    {
      "type": "ExpansionPanel",
      "caption": "üöó Fahrzeugdaten & Ziel-SOC",
      "items": [
        { "type": "Label", "label": "üìä Fahrzeugdaten f√ºr SoC-basierte Ladesteuerung verwenden (optional)." },
        { "type": "CheckBox", "name": "UseCarSOC", "caption": "Fahrzeugdaten ber√ºcksichtigen" },
        { "type": "Label", "caption": "    " },
        { "type": "Label", "caption": "üîã Aktueller SoC des Fahrzeugs (Einheit: %, positiv) & üîã Fallback SoC in %, wenn keine Variable angegeben ist (positiv)." },
        { "type": "RowLayout", "items": [
          { "type": "SelectVariable", "name": "CarSOCID", "caption": "Aktueller SoC (Variable)" },
          { "type": "Label", "caption": "    " },
          { "type": "NumberSpinner", "name": "CarSOCFallback", "caption": "Fallback SoC (%)", "suffix": "%" }
        ]},
        { "type": "Label", "caption": "    " },
        { "type": "Label", "caption": "üéØ Ziel-SoC f√ºr das Fahrzeug (Einheit: %, positiv, z.B. 80) & üéØ Fallback Ziel-SoC in %, wenn keine Variable angegeben ist (positiv, z.B. 80)." },
        { "type": "RowLayout", "items": [
        { "type": "SelectVariable", "name": "CarTargetSOCID", "caption": "Ziel-SoC (Variable)" },
        { "type": "Label", "caption": "    " },
        { "type": "NumberSpinner", "name": "CarTargetSOCFallback", "caption": "Fallback Ziel-SoC (%)", "suffix": "%" }
        ]},
        { "type": "Label", "caption": "    " },
        { "type": "Label", "label": "‚ö°Ô∏è Maximale Fahrzeug-Ladeleistung (W) 'minimum': 0 W, 'maximum': 22000 W " },
        { "type": "NumberSpinner", "name": "MaxAutoWatt", "caption": "Max. Ladeleistung Fahrzeug (W)", "suffix": "W", "minimum": 0, "maximum": 22000 },
        { "type": "Label", "caption": "    " },
        { "type": "Label", "label": "üîã Batteriekapazit√§t des Fahrzeugs in kWh (z. B. 52 f√ºr ID.3 Pure)." },
        { "type": "NumberSpinner", "name": "CarBatteryCapacity", "caption": "Batteriekapazit√§t (kWh)", "suffix": "kWh" },
        { "type": "Label", "caption": "    " },
        { "type": "Label", "caption": "Wenn aktiviert, wird das Fahrzeug nie √ºber den Ziel-SOC geladen ‚Äì egal ob bei PV-√úberschuss, Zielzeitladung oder Strompreis." },
        { "type": "CheckBox", "name": "AlwaysUseTargetSOC", "caption": "üéØ Ziel-SOC immer ber√ºcksichtigen (auch bei PV-√úberschussladung)", "default": false }
      ]
    },
    {
      "type": "ExpansionPanel",
      "caption": "üìâ Strompreis-B√∂rse / Forecast",
      "items": [
        {
          "type": "CheckBox",
          "name": "UseMarketPrices",
          "caption": "Strompreisb√∂rsenpreise aktivieren (Awattar, Tibber ...)"
        },
        {
          "type": "Select",
          "name": "MarketPriceProvider",
          "caption": "Provider",
          "options": [
            { "caption": "Awattar √ñsterreich", "value": "awattar_at" },
            { "caption": "Awattar Deutschland", "value": "awattar_de" },
            { "caption": "Custom API", "value": "custom" }
          ],
          "default": "awattar_at"
        },
        { "type": "Label", "caption": "    " },
        { "type": "Label", "label": "üîó Die API-URL muss **nur** bei Auswahl von 'Custom API' ausgef√ºllt werden. Bei Awattar wird die URL automatisch gesetzt!"},
        {
          "type": "ValidationTextBox",
          "name": "MarketPriceAPI",
          "caption": "API-URL (nur f√ºr Experten/Custom)",
          "default": ""
        },
        { "type": "Label", "caption": "    " },
        {
          "type": "NumberSpinner",
          "name": "MarketPriceInterval",
          "caption": "Abrufintervall in Minuten",
          "suffix": "min",
          "minimum": 10,
          "maximum": 120,
          "default": 30
        },
        {"type": "Label", "label": "Der aktuelle B√∂rsenpreis-Forecast wird automatisch in die Variable 'MarketPrices' geschrieben."},
        {"type": "Label", "label": "Die Preise werden alle X Minuten aktualisiert und k√∂nnen in der Lade-Logik verwendet werden."},
        {
        "type": "Label",
        "label": "Die aktuelle B√∂rsenpreis-Vorschau findest du im WebFront unter 'Preisvorschau'."
      }
      ]
    }
  ]
}
