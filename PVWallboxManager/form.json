{
  "elements": [
    {
      "type": "ExpansionPanel",
      "caption": "üõë Modulsteuerung",
      "items": [
        { "type": "CheckBox", "name": "ModulAktiv", "caption": "‚ö° Modul aktiv (bei Deaktivierung werden keine Aktionen ausgef√ºhrt)"},
        { "type": "CheckBox", "name": "DebugLogging", "caption": "üêû Debug-Logging aktivieren (Details zu allen Variablen und Werten ins IPS-Log)", "default": false },
        { "type": "Button", "caption": "Lock zur√ºcksetzen", "icon": "Unlock", "onClick": "ResetLock"},
        { "type": "Label", "caption": "Verwenden Sie diesen Button nur, wenn das Modul nicht mehr automatisch arbeitet und wiederholt die Warnung 'UpdateCharging() l√§uft bereits ‚Äì neuer Aufruf wird abgebrochen.' anzeigt.\nDer Button setzt den internen Schutzmechanismus (Lock) zur√ºck, sodass das Modul wieder ausgef√ºhrt werden kann."}
      ]
    },
    {
      "type": "ExpansionPanel",
      "caption": "üîå Wallbox-Konfiguration",
      "icon": "Plug",
      "items": [
        { "type": "Label", "label": "‚öôÔ∏è Konfiguriere hier deine GO-e Wallbox und Ladeparameter & üîå Ladestr√∂me." },
        { "type": "RowLayout", "items": [
          { "type": "ValidationTextBox", "name": "WallboxIP", "caption": "Wallbox-IP"},
          { "type": "Label", "caption": "    " },
          { "type": "NumberSpinner", "name": "RefreshInterval", "caption": "Aktualisierungsintervall (15‚Äì600s)", "minimum": 15, "maximum": 600 },
          { "type": "Label", "caption": "    " },
          { "type": "NumberSpinner", "name": "InitialCheckInterval", "caption": "Initial-Check Intervall (0 = deaktivert)", "suffix": "Sek.", "minimum": 0, "maximum": 60 }
        ]},
        { "type": "RowLayout", "items": [
          { "type": "PasswordTextBox", "name": "WallboxAPIKey", "caption": "API-Key (optional)"}
        ]},
        { "type": "RowLayout", "items": [
          { "type": "NumberSpinner", "name": "MinAmpere", "caption": "Minimaler Ladestrom (A)", "icon": "Minus", "suffix": "A", "minimum": 6, "maximum": 16, "default": 6 },
          { "type": "Label", "caption": "    " },
          { "type": "NumberSpinner", "name": "MaxAmpere", "caption": "Maximaler Ladestrom (A)", "icon": "Plus", "suffix": "A", "minimum": 6, "maximum": 16, "default": 16 }
        ]},
        { "type": "Label", "caption": "    " },
        { "type": "Label", "label": "üü¢ Startwert: Ab diesem PV-√úberschuss startet das Laden. Die Hysterese legt fest, wie oft der Wert √ºberschritten sein muss." },
        { "type": "RowLayout", "items": [
          { "type": "NumberSpinner", "name": "MinLadeWatt", "caption": "Start bei PV-√úberschuss (W)", "icon": "Play" },
          { "type": "Label", "caption": "    " },
          { "type": "NumberSpinner", "name": "StartLadeHysterese", "caption": "Start-Hysterese (Zyklen)", "suffix": "Zyklen", "default": 0, "minimum": 0, "maximum": 10, "icon": "Repeat" }
        ]},
        { "type": "Label", "caption": "    " },
        { "type": "Label", "label": "üõë Stopwert: Unter diesem Wert wird die Ladung gestoppt. Hysterese = wie oft der Wert unterschritten sein muss." },
        { "type": "RowLayout", "items": [
          { "type": "NumberSpinner", "name": "MinStopWatt", "caption": "Stop bei fehlendem PV-√úberschuss (W)", "icon": "Pause" },
          { "type": "Label", "caption": "    " },
          { "type": "NumberSpinner", "name": "StopLadeHysterese", "caption": "Stop-Hysterese (Zyklen)", "suffix": "Zyklen", "default": 0, "minimum": 0, "maximum": 10, "icon": "Repeat" }
        ]},
        { "type": "Label", "caption": "    " },
        { "type": "Label", "label": "MQTT Server" },
        { "type": "RowLayout", "items": [
          { "type": "SelectInstance", "name": "MQTTServer", "caption": "MQTT Server Instanz", "validParentTypes": ["{A2A93E16-F7B0-47C6-97FE-A3C8ABCF8C1D}"] },
          { "type": "Label", "caption": "    " },
          { "type": "ValidationTextBox", "name": "WallboxID", "caption": "Wallbox ID (Seriennummer)" },
          { "type": "Label", "caption": "    " },
          { "type": "Select", "name": "SelectedGoETopic", "caption": "Anzuzeigende MQTT Topics ausw√§hlen", "multiple": true, 
              "options": [
                { "caption": "Ladeleistung (nrg)", "value": "go-eCharger/285450/nrg" },
                { "caption": "Phasenstatus (psm)", "value": "go-eCharger/285450/psm" }
              ]}
        ]}
      ]
    },
    {
      "type": "ExpansionPanel",
      "caption": "üåû Energiequellen",
      "items": [
        { "type": "Label", "label": "üåÖ PV-Erzeugung (Pflichtvariable): Leistung der PV-Anlage." },
        { "type": "RowLayout", "items": [
          { "type": "SelectVariable", "name": "PVErzeugungID", "caption": "PV-Erzeugung", "validVariableTypes": [2] },
          { "type": "Label", "caption": "    " },
          { "type": "Select", "name": "PVErzeugungEinheit", "caption": "Einheit", "options": [
            { "caption": "Watt (W)", "value": "W" },
            { "caption": "Kilowatt (kW)", "value": "kW" } ], "default": "W" }
        ]},
        { "type": "Label", "label": "üè† Hausverbrauch (Pflichtvariable): Aktueller Gesamtverbrauch." },
        { "type": "RowLayout", "items": [
          { "type": "SelectVariable", "name": "HausverbrauchID", "caption": "Gesamter Hausverbrauch", "validVariableTypes": [2] },
          { "type": "Label", "caption": "    " },
          { "type": "Select", "name": "HausverbrauchEinheit", "caption": "Einheit", "options": [
            { "caption": "Watt (W)", "value": "W" },
            { "caption": "Kilowatt (kW)", "value": "kW" } ], "default": "W" },
          { "type": "Label", "caption": "         " },
          { "type": "CheckBox", "name": "InvertHausverbrauch", "caption": "Normal positiv. Falls dein Z√§hler negativ liefert, hier invertieren." }
        ]},
        { "type": "Label", "label": "üîã Batterieladung (optional): Lade- oder Entladeleistung der Hausbatterie. Wenn keine Variable ausgew√§hlt ist, wird 0 verwendet." },
        { "type": "RowLayout", "items": [
          { "type": "SelectVariable", "name": "BatterieladungID", "caption": "Batterieladung", "validVariableTypes": [2] },
          { "type": "Label", "caption": "    " },
          { "type": "Select", "name": "BatterieladungEinheit", "caption": "Einheit", "options": [
            { "caption": "Watt (W)", "value": "W" },
            { "caption": "Kilowatt (kW)", "value": "kW" } ], "default": "W" },
          { "type": "Label", "caption": "         " },
          { "type": "CheckBox", "name": "InvertBatterieladung", "caption": "Positiv = Laden, negativ = Entladen. Falls dein System umgekehrte Vorzeichen liefert, hier invertieren." }
        ]}
      ]
    },
    {
      "type": "ExpansionPanel",
      "caption": "‚ö° Phasenumschaltung",
      "items": [
        { "type": "Label", "label": "‚¨áÔ∏è Schwelle in Watt zum Umschalten auf 1-phasig & üî¢ Z√§hlerlimit f√ºr stabile Umschaltung auf 1-phasig." },
         { "type": "RowLayout", "items": [
           { "type": "NumberSpinner", "name": "Phasen1Schwelle", "caption": "Schwelle auf 1-phasig (W)" },
           { "type": "Label", "caption": "    " },
            { "type": "NumberSpinner", "name": "Phasen1Limit", "caption": "Z√§hlerlimit 1-phasig" }
        ]},
        { "type": "Label", "caption": "    " },
        { "type": "Label", "label": "‚¨ÜÔ∏è Schwelle in Watt zum Umschalten auf 3-phasig & üî¢ Z√§hlerlimit f√ºr stabile Umschaltung auf 3-phasig." },
           { "type": "RowLayout", "items": [
             { "type": "NumberSpinner", "name": "Phasen3Schwelle", "caption": "Schwelle auf 3-phasig (W)" },
             { "type": "Label", "caption": "    " },
             { "type": "NumberSpinner", "name": "Phasen3Limit", "caption": "Z√§hlerlimit 3-phasig" }
        ]}
      ]
    },
    {
      "type": "ExpansionPanel",
      "caption": "üß† Intelligente Logik",
      "items": [
        { "type": "Label", "caption": "    " },
        { "type": "Label", "label": "‚öñÔ∏è PV-Leistung zwischen Haus und Auto aufteilen (PV2Car-Regelung)." },
        { "type": "Label", "label": "‚òÄÔ∏è **Die Aktivierung und der Anteil f√ºrs Fahrzeug werden direkt im WebFront gesteuert!**" },
        { "type": "RowLayout", "items": [
          { "type": "SelectVariable", "name": "HausakkuSOCID", "caption": "Hausakku SoC (%)" },
          { "type": "Label", "caption": "    " },
          { "type": "NumberSpinner", "name": "HausakkuSOCVollSchwelle", "caption": "Voll-Schwelle Hausbatterie (%)", "suffix": "%", "minimum": 50, "maximum": 100 }
        ]}
      ]
    },
    {
      "type": "ExpansionPanel",
      "caption": "üöó Fahrzeugdaten & Ziel-SOC",
      "items": [
        { "type": "Label", "label": "üîã Aktueller SoC des Fahrzeugs & üéØ Ziel-SoC f√ºr das Fahrzeug" },
        { "type": "RowLayout", "items": [
          { "type": "SelectVariable", "name": "CarSOCID", "caption": "Aktueller SoC des Fahrzeugs", "suffix": "%", "minimum": 0, "maximum": 100 },
          { "type": "Label", "caption": "    " },
          { "type": "SelectVariable", "name": "CarTargetSOCID", "caption": "Ziel-SoC f√ºr das Fahrzeug" }
        ]},
        { "type": "Label", "caption": "    " },
        { "type": "Label", "label": "üîã Batteriekapazit√§t des Fahrzeugs in kWh (z. B. 52 f√ºr ID.3 Pure):" },
        { "type": "RowLayout", "items": [
          { "type": "NumberSpinner", "name": "CarBatteryCapacity", "caption": "Batteriekapazit√§t (kWh)", "suffix": "kWh" }
        ]}
      ]
    },
    {
      "type": "ExpansionPanel",
      "caption": "üìâ Strompreis-B√∂rse / Forecast",
      "items": [
        {
          "type": "CheckBox",
          "name": "UseMarketPrices",
          "caption": "Strompreisb√∂rsenpreise aktivieren (Awattar, ...)"
        },
        {
          "type": "Label",
          "label": "Die Preise werden automatisch zu jeder vollen Stunde und beim Aktivieren aktualisiert."
        },
        {
          "type": "Select",
          "name": "MarketPriceProvider",
          "caption": "Provider",
          "options": [
            { "caption": "Awattar √ñsterreich", "value": "awattar_at" },
            { "caption": "Awattar Deutschland", "value": "awattar_de" },
            { "caption": "Custom API", "value": "custom" }
          ],
          "default": "awattar_at"
        },
        { "type": "Label", "caption": "    " },
        { "type": "Label", "label": "üîó Die API-URL muss **nur** bei Auswahl von 'Custom API' ausgef√ºllt werden. Bei Awattar wird die URL automatisch gesetzt!" },
        {
          "type": "ValidationTextBox",
          "name": "MarketPriceAPI",
          "caption": "API-URL (nur f√ºr Experten/Custom)",
          "default": ""
        },
        { "type": "Label", "caption": "    " },
        {
          "type": "Label",
          "label": "B√∂rsenpreise und Vorschau erscheinen im WebFront und werden in die Variable 'CurrentSpotPrice' geschrieben."
        }
      ]
    }
  ]
}
